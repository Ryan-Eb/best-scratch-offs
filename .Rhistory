data <- fromJSON(rawToChar(response$content))
game <- data$games
ca_name_data <- game %>% unnest(prizeTiers) %>%
filter(state == "Active") %>%
select(7,13) %>%
mutate(state = "CA") %>%
rename(game_number = gameNumber,
game_name = name) %>%
relocate(state, .before = game_number)
game_names <- bind_rows(game_names, ca_name_data)
## MA ####
ma_names_url <- "https://www.masslottery.com/api/v1/games"
ma_name_data <- fromJSON(ma_names_url) %>%
select(id, name, gameType) %>%
filter(gameType == "Scratch") %>%
select(id, name) %>%
rename(game_number = id,
game_name = name)
game_names <- bind_rows(game_names, ma_name_data)
## LA ####
la_names_url <- "https://louisianalottery.com/scratch-offs/top-prizes-remaining"
la_name_data <- read_html(la_names_url) %>% html_nodes("table") %>% html_table() %>% .[[1]] %>%
select(1,2) %>%
mutate(state = "LA") %>%
mutate(game_number = No. %>% as.numeric(),
game_name = `Game Name`) %>%
select(3:5)
game_names <- bind_rows(game_names, la_name_data)
## NY ####
ny_json_names <- "https://data.ny.gov/resource/nzqa-7unk.json"
ny_name_data <- fromJSON(ny_json) %>% select(1,2) %>%
distinct() %>%
mutate(state = "NY") %>%
mutate(game_number = game_number %>% as.numeric()) %>%
relocate(state, .before = game_number)
game_names <- bind_rows(game_names, ny_name_data)
## GAME NAME COMPILE ####
game_names <- distinct(game_names)
getwd()
setwd("/Users/jennaryan/Documents/GitHub/all_lotto_states")
write.csv(game_names,"game_name_list.csv", row.names = FALSE)
View(game_names)
ma_name_data <- fromJSON(ma_names_url) %>%
select(id, name, gameType) %>%
filter(gameType == "Scratch") %>%
mutate(state = "MA") %>%
select(state,id, name) %>%
rename(game_number = id,
game_name = name)
# STATE GAME NAMES ####
game_names <- data.frame()
## FL ####
fl_names_url <- "https://www.flalottery.com/remainingPrizes"
fl_names <- read_html(fl_names_url) %>% html_nodes("table") %>% html_table() %>% .[[1]] %>%
select(1,2) %>%
mutate(state = "FL") %>%
mutate(game_number = as.numeric(`Game Number`)) %>%
mutate(game_name = `Game Name`) %>%
select(state:game_name)
game_names <- bind_rows(game_names, fl_names)
## TX ####
tx_names_url <- "https://www.texaslottery.com/export/sites/lottery/Games/Scratch_Offs/all.html"
tx_names <- read_html(tx_names_url) %>% html_nodes("table") %>% html_table() %>% .[[1]] %>%
select(`Game Number`, `Game Name`) %>%
drop_na() %>%
mutate(state = 'TX') %>%
mutate(game_number = as.numeric(`Game Number`)) %>%
mutate(game_name = `Game Name`) %>%
select(state:game_name)
game_names <- bind_rows(game_names, tx_names)
## NC ####
nc_names_url <- "https://nclottery.com/scratch-off-prizes-remaining"
nc_names <- data.frame(
state = "NC",
game_number = c(read_html(nc_names_url) %>% html_nodes(".gamenumber") %>% html_text2() %>%
str_extract("\\d+") %>% as.numeric()),
game_name = c(read_html(nc_names_url) %>% html_nodes(".gamename") %>% html_text2() %>%
str_replace_all("â","'") %>% str_replace_all("â¢","") %>%
str_replace_all("Â","")))
game_names <- bind_rows(game_names, nc_names)
## IL ####
il_names_url <- "https://www.illinoislottery.com/about-the-games/unpaid-instant-games-prizes"
il_names <- read_html(il_names_url) %>% html_nodes("table") %>% html_table() %>% .[[1]] %>% select(1,3) %>%
mutate(state = "IL") %>%
mutate(game_number = str_split(.[[2]],"[(]", simplify = TRUE) %>% .[,1] %>% as.numeric()) %>%
mutate(game_name = str_split(.[[1]]," \\(", simplify = TRUE) %>% .[,1]) %>%
select(3,4,5) %>%
drop_na()
game_names <- bind_rows(game_names, il_names)
## CT ####
ct_names_url <- "https://www.ctlottery.org/ScratchGamesTable"
ct_names <- read_html(ct_names_url) %>% html_nodes("table") %>% html_table() %>% .[[1]] %>% select(1,2) %>%
mutate(state = "CT") %>%
mutate(game_number = as.numeric(Game)) %>%
mutate(game_name = `Game Name`) %>%
select(3:5)
game_names <- bind_rows(game_names, ct_names)
## CA ####
ca_names_url <- "https://www.calottery.com/api/games/scratchers"
response <- GET(ca_names_url)
data <- fromJSON(rawToChar(response$content))
game <- data$games
ca_name_data <- game %>% unnest(prizeTiers) %>%
filter(state == "Active") %>%
select(7,13) %>%
mutate(state = "CA") %>%
rename(game_number = gameNumber,
game_name = name) %>%
relocate(state, .before = game_number)
game_names <- bind_rows(game_names, ca_name_data)
## MA ####
ma_names_url <- "https://www.masslottery.com/api/v1/games"
ma_name_data <- fromJSON(ma_names_url) %>%
select(id, name, gameType) %>%
filter(gameType == "Scratch") %>%
mutate(state = "MA") %>%
select(state,id, name) %>%
rename(game_number = id,
game_name = name)
game_names <- bind_rows(game_names, ma_name_data)
## LA ####
la_names_url <- "https://louisianalottery.com/scratch-offs/top-prizes-remaining"
la_name_data <- read_html(la_names_url) %>% html_nodes("table") %>% html_table() %>% .[[1]] %>%
select(1,2) %>%
mutate(state = "LA") %>%
mutate(game_number = No. %>% as.numeric(),
game_name = `Game Name`) %>%
select(3:5)
game_names <- bind_rows(game_names, la_name_data)
## NY ####
ny_json_names <- "https://data.ny.gov/resource/nzqa-7unk.json"
ny_name_data <- fromJSON(ny_json) %>% select(1,2) %>%
distinct() %>%
mutate(state = "NY") %>%
mutate(game_number = game_number %>% as.numeric()) %>%
relocate(state, .before = game_number)
game_names <- bind_rows(game_names, ny_name_data)
## GAME NAME COMPILE ####
game_names <- distinct(game_names)
getwd()
setwd("/Users/jennaryan/Documents/GitHub/all_lotto_states")
write.csv(game_names,"game_name_list.csv", row.names = FALSE)
View(game_names)
knitr::opts_chunk$set(echo = FALSE,
warning = FALSE,
message = FALSE,
fig.align = "center")
source("/Users/jennaryan/Documents/GitHub/all_lotto_states/all_states_analysis.R")
st = "MA"
avg_sold_per_day <- tsd %>%
filter(state == st) %>%
summarise(aspd = mean(tickets_sold_per_day)) %>%
.[,2] %>%
as.numeric() %>%
round(0)
total_amount_remain <- df %>%
filter(state == st) %>%
filter(scrape_date == max(scrape_date)) %>%
drop_na() %>%
summarise(tpr = sum(prize_amount * prizes_remaining)) %>%
as.numeric() %>%
round(0)
top_remaining <- df %>%
filter(state == st) %>%
filter(scrape_date == max(scrape_date)) %>%
drop_na() %>%
filter(prize_amount >= 1000000) %>%
summarise(npr = sum(prizes_remaining)) %>%
as.numeric()
x1 = -77.5
y1 = 40
MA_logo <- ggplot2::map_data("state","Massachusetts") %>%
ggplot(aes(long,lat))+
geom_polygon(fill = "white", color = "black", linewidth=2)+
annotate("rect",
xmin = x1+.4,
xmax = x1+2.4,
ymin = y1+.4,
ymax = y1+2.4,
fill = "white",
color = "black",
linetype = 2)+
annotate("rect",
xmin = x1+.2,
xmax = x1+2.2,
ymin = y1+.2,
ymax = y1+2.2,
fill = "white",
color = "black",
linetype = 2)+
annotate("rect",
xmin = x1,
xmax = x1+2,
ymin = y1,
ymax = y1+2,
fill = "white",
color = "black",
linetype = 2)+
annotate("rect",
xmin = c(x1+.1, x1+.5, x1+.9, x1+1.3, x1+1.7),
xmax = c(x1+.3, x1+.7, x1+1.1, x1+1.5, x1+1.9),
ymin = y1+.1,
ymax = y1+.3)+
annotate("rect",
xmin = c(x1+.1, x1+.5, x1+.9, x1+1.3, x1+1.7),
xmax = c(x1+.3, x1+.7, x1+1.1, x1+1.5, x1+1.9),
ymin = y1+.4,
ymax = y1+.6)+
annotate("rect",
xmin = c(x1+.1, x1+.5, x1+.9, x1+1.3, x1+1.7),
xmax = c(x1+.3, x1+.7, x1+1.1, x1+1.5, x1+1.9),
ymin = y1+.7,
ymax = y1+.9)+
annotate("text",
x = x1+1,
y = y1 +1.3,
label = "$ $ $ $",
size = 5)+
annotate("text",
x = x1+1,
y = y1 +1.7,
label = "WINNER",
size = 5)+
annotate("text",
x = x1+1.3,
y = y1+2.9,
label = "best-scratch-offs.com/ny",
size = 5,
fontface = "bold")+
coord_quickmap()+
theme_bw()+
theme(panel.grid = element_blank(),
panel.border = element_blank(),
line = element_blank(),
text = element_blank(),
plot.margin = margin(0,0,0,0))
MA_logo
x1 = -75
y1 = 40
MA_logo <- ggplot2::map_data("state","Massachusetts") %>%
ggplot(aes(long,lat))+
geom_polygon(fill = "white", color = "black", linewidth=2)+
annotate("rect",
xmin = x1+.4,
xmax = x1+2.4,
ymin = y1+.4,
ymax = y1+2.4,
fill = "white",
color = "black",
linetype = 2)+
annotate("rect",
xmin = x1+.2,
xmax = x1+2.2,
ymin = y1+.2,
ymax = y1+2.2,
fill = "white",
color = "black",
linetype = 2)+
annotate("rect",
xmin = x1,
xmax = x1+2,
ymin = y1,
ymax = y1+2,
fill = "white",
color = "black",
linetype = 2)+
annotate("rect",
xmin = c(x1+.1, x1+.5, x1+.9, x1+1.3, x1+1.7),
xmax = c(x1+.3, x1+.7, x1+1.1, x1+1.5, x1+1.9),
ymin = y1+.1,
ymax = y1+.3)+
annotate("rect",
xmin = c(x1+.1, x1+.5, x1+.9, x1+1.3, x1+1.7),
xmax = c(x1+.3, x1+.7, x1+1.1, x1+1.5, x1+1.9),
ymin = y1+.4,
ymax = y1+.6)+
annotate("rect",
xmin = c(x1+.1, x1+.5, x1+.9, x1+1.3, x1+1.7),
xmax = c(x1+.3, x1+.7, x1+1.1, x1+1.5, x1+1.9),
ymin = y1+.7,
ymax = y1+.9)+
annotate("text",
x = x1+1,
y = y1 +1.3,
label = "$ $ $ $",
size = 5)+
annotate("text",
x = x1+1,
y = y1 +1.7,
label = "WINNER",
size = 5)+
annotate("text",
x = x1+1.3,
y = y1+2.9,
label = "best-scratch-offs.com/ny",
size = 5,
fontface = "bold")+
coord_quickmap()+
theme_bw()+
theme(panel.grid = element_blank(),
panel.border = element_blank(),
line = element_blank(),
text = element_blank(),
plot.margin = margin(0,0,0,0))
MA_logo
x1 = -73
y1 = 38
MA_logo <- ggplot2::map_data("state","Massachusetts") %>%
ggplot(aes(long,lat))+
geom_polygon(fill = "white", color = "black", linewidth=2)+
annotate("rect",
xmin = x1+.4,
xmax = x1+2.4,
ymin = y1+.4,
ymax = y1+2.4,
fill = "white",
color = "black",
linetype = 2)+
annotate("rect",
xmin = x1+.2,
xmax = x1+2.2,
ymin = y1+.2,
ymax = y1+2.2,
fill = "white",
color = "black",
linetype = 2)+
annotate("rect",
xmin = x1,
xmax = x1+2,
ymin = y1,
ymax = y1+2,
fill = "white",
color = "black",
linetype = 2)+
annotate("rect",
xmin = c(x1+.1, x1+.5, x1+.9, x1+1.3, x1+1.7),
xmax = c(x1+.3, x1+.7, x1+1.1, x1+1.5, x1+1.9),
ymin = y1+.1,
ymax = y1+.3)+
annotate("rect",
xmin = c(x1+.1, x1+.5, x1+.9, x1+1.3, x1+1.7),
xmax = c(x1+.3, x1+.7, x1+1.1, x1+1.5, x1+1.9),
ymin = y1+.4,
ymax = y1+.6)+
annotate("rect",
xmin = c(x1+.1, x1+.5, x1+.9, x1+1.3, x1+1.7),
xmax = c(x1+.3, x1+.7, x1+1.1, x1+1.5, x1+1.9),
ymin = y1+.7,
ymax = y1+.9)+
annotate("text",
x = x1+1,
y = y1 +1.3,
label = "$ $ $ $",
size = 5)+
annotate("text",
x = x1+1,
y = y1 +1.7,
label = "WINNER",
size = 5)+
annotate("text",
x = x1+1.3,
y = y1+2.9,
label = "best-scratch-offs.com/ma",
size = 5,
fontface = "bold")+
coord_quickmap()+
theme_bw()+
theme(panel.grid = element_blank(),
panel.border = element_blank(),
line = element_blank(),
text = element_blank(),
plot.margin = margin(0,0,0,0))
MA_logo
ggplot2::map_data("state","Massachusetts") %>%
ggplot(aes(long,lat))+
geom_polygon(fill = "white", color = "black", linewidth=2)
x1 = -73.1
y1 = 38
MA_logo <- ggplot2::map_data("state","Massachusetts") %>%
ggplot(aes(long,lat))+
geom_polygon(fill = "white", color = "black", linewidth=2)+
annotate("rect",
xmin = x1+.4,
xmax = x1+2.4,
ymin = y1+.4,
ymax = y1+2.4,
fill = "white",
color = "black",
linetype = 2)+
annotate("rect",
xmin = x1+.2,
xmax = x1+2.2,
ymin = y1+.2,
ymax = y1+2.2,
fill = "white",
color = "black",
linetype = 2)+
annotate("rect",
xmin = x1,
xmax = x1+2,
ymin = y1,
ymax = y1+2,
fill = "white",
color = "black",
linetype = 2)+
annotate("rect",
xmin = c(x1+.1, x1+.5, x1+.9, x1+1.3, x1+1.7),
xmax = c(x1+.3, x1+.7, x1+1.1, x1+1.5, x1+1.9),
ymin = y1+.1,
ymax = y1+.3)+
annotate("rect",
xmin = c(x1+.1, x1+.5, x1+.9, x1+1.3, x1+1.7),
xmax = c(x1+.3, x1+.7, x1+1.1, x1+1.5, x1+1.9),
ymin = y1+.4,
ymax = y1+.6)+
annotate("rect",
xmin = c(x1+.1, x1+.5, x1+.9, x1+1.3, x1+1.7),
xmax = c(x1+.3, x1+.7, x1+1.1, x1+1.5, x1+1.9),
ymin = y1+.7,
ymax = y1+.9)+
annotate("text",
x = x1+1,
y = y1 +1.3,
label = "$ $ $ $",
size = 5)+
annotate("text",
x = x1+1,
y = y1 +1.7,
label = "WINNER",
size = 5)+
annotate("text",
x = x1+1.3,
y = y1+2.9,
label = "best-scratch-offs.com/ma",
size = 5,
fontface = "bold")+
coord_quickmap()+
theme_bw()+
theme(panel.grid = element_blank(),
panel.border = element_blank(),
line = element_blank(),
text = element_blank(),
plot.margin = margin(0,0,0,0))
MA_logo
x1 = -73.
y1 = 38
MA_logo <- ggplot2::map_data("state","Massachusetts") %>%
ggplot(aes(long,lat))+
geom_polygon(fill = "white", color = "black", linewidth=2)+
annotate("rect",
xmin = x1+.4,
xmax = x1+2.4,
ymin = y1+.4,
ymax = y1+2.4,
fill = "white",
color = "black",
linetype = 2)+
annotate("rect",
xmin = x1+.2,
xmax = x1+2.2,
ymin = y1+.2,
ymax = y1+2.2,
fill = "white",
color = "black",
linetype = 2)+
annotate("rect",
xmin = x1,
xmax = x1+2,
ymin = y1,
ymax = y1+2,
fill = "white",
color = "black",
linetype = 2)+
annotate("rect",
xmin = c(x1+.1, x1+.5, x1+.9, x1+1.3, x1+1.7),
xmax = c(x1+.3, x1+.7, x1+1.1, x1+1.5, x1+1.9),
ymin = y1+.1,
ymax = y1+.3)+
annotate("rect",
xmin = c(x1+.1, x1+.5, x1+.9, x1+1.3, x1+1.7),
xmax = c(x1+.3, x1+.7, x1+1.1, x1+1.5, x1+1.9),
ymin = y1+.4,
ymax = y1+.6)+
annotate("rect",
xmin = c(x1+.1, x1+.5, x1+.9, x1+1.3, x1+1.7),
xmax = c(x1+.3, x1+.7, x1+1.1, x1+1.5, x1+1.9),
ymin = y1+.7,
ymax = y1+.9)+
annotate("text",
x = x1+1,
y = y1 +1.3,
label = "$ $ $ $",
size = 5)+
annotate("text",
x = x1+1,
y = y1 +1.7,
label = "WINNER",
size = 5)+
annotate("text",
x = x1+1.3,
y = y1+2.9,
label = "best-scratch-offs.com/ma",
size = 5,
fontface = "bold")+
coord_quickmap()+
theme_bw()+
theme(panel.grid = element_blank(),
panel.border = element_blank(),
line = element_blank(),
text = element_blank(),
plot.margin = margin(0,0,0,0))
MA_logo
